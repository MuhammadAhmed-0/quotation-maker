<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Quotation Maker</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
            min-height: 600px;
        }
        
        .form-section {
            padding: 40px;
            background: #f8fafc;
            border-right: 2px solid #e2e8f0;
        }
        
        .preview-section {
            padding: 40px;
            background: white;
            position: relative;
        }
        
        .section-title {
            font-size: 1.5em;
            color: #2d3748;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title::before {
            content: '';
            width: 4px;
            height: 30px;
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            border-radius: 2px;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #4a5568;
            font-weight: 600;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1em;
            transition: all 0.3s ease;
            background: white;
        }
        
        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
            transform: translateY(-1px);
        }
        
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .service-item {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .service-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .service-item:hover {
            border-color: #4facfe;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.15);
        }
        
        .service-item:hover::before {
            transform: scaleX(1);
        }
        
        .service-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .service-checkbox {
            margin-right: 15px;
            width: 20px;
            height: 20px;
            accent-color: #4facfe;
        }
        
        .service-name {
            font-weight: 600;
            color: #2d3748;
            font-size: 1.1em;
        }
        
        .service-details {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }
        
        .service-details input {
            padding: 8px 10px;
            font-size: 0.9em;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
        }
        
        .btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.4);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.6);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .quote-preview {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.07);
            font-family: 'Times New Roman', serif;
            line-height: 1.6;
        }
        
        .quote-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #4facfe;
        }
        
        .company-name {
            font-size: 2em;
            color: #2d3748;
            margin-bottom: 5px;
            font-weight: 700;
        }
        
        .quote-title {
            font-size: 1.4em;
            color: #4facfe;
            margin: 15px 0;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .quote-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .detail-section h4 {
            color: #4a5568;
            margin-bottom: 10px;
            font-size: 1.1em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .services-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            font-size: 0.95em;
        }
        
        .services-table th {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
            padding: 15px 10px;
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .services-table td {
            padding: 12px 10px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .services-table tr:nth-child(even) {
            background-color: #f8fafc;
        }
        
        .total-section {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .final-total {
            font-size: 1.4em;
            font-weight: 700;
            color: #2d3748;
            border-top: 2px solid #4facfe;
            padding-top: 15px;
            margin-top: 15px;
        }
        
        .quote-footer {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e2e8f0;
            text-align: center;
            color: #4a5568;
            font-style: italic;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            justify-content: center;
        }
        
        .currency-symbol {
            font-weight: 600;
            color: #4facfe;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .form-section {
                border-right: none;
                border-bottom: 2px solid #e2e8f0;
            }
            
            .services-grid {
                grid-template-columns: 1fr;
            }
            
            .quote-details {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Professional Quotation Maker</h1>
            <p>Create stunning quotes for Digital Marketing, Web Development & ERP Services</p>
        </div>
        
        <div class="main-content">
            <div class="form-section">
                <h2 class="section-title">Quote Configuration</h2>
                
                <div class="form-group">
                    <label>Your Company Name</label>
                    <input type="text" id="companyName" placeholder="Enter your company name" value="Your Digital Agency">
                </div>
                
                <div class="form-group">
                    <label>Client Name</label>
                    <input type="text" id="clientName" placeholder="Enter client name">
                </div>
                
                <div class="form-group">
                    <label>Client Email</label>
                    <input type="email" id="clientEmail" placeholder="Enter client email">
                </div>
                
                <div class="form-group">
                    <label>Quote Number</label>
                    <input type="text" id="quoteNumber" placeholder="QT-001">
                </div>
                
                <div class="form-group">
                    <label>Currency</label>
                    <select id="currency">
                        <option value="$">USD ($)</option>
                        <option value="€">EUR (€)</option>
                        <option value="£">GBP (£)</option>
                        <option value="₹">INR (₹)</option>
                        <option value="¥">JPY (¥)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Tax Rate (%)</label>
                    <input type="number" id="taxRate" placeholder="18" value="18">
                </div>
                
                <div class="form-group">
                    <label>Valid Until</label>
                    <input type="date" id="validUntil">
                </div>
                
                <h3 class="section-title" style="margin-top: 30px;">Select Services</h3>
                
                <div class="services-grid">
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="webdev">
                            <span class="service-name">Web Development</span>
                        </div>
                        <div class="service-details">
                            <input type="number" placeholder="Quantity" class="service-qty" data-service="webdev">
                            <input type="number" placeholder="Price" class="service-price" data-service="webdev">
                            <input type="text" placeholder="Unit" class="service-unit" data-service="webdev" value="Project">
                        </div>
                    </div>
                    
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="seo">
                            <span class="service-name">SEO Services</span>
                        </div>
                        <div class="service-details">
                            <input type="number" placeholder="Quantity" class="service-qty" data-service="seo">
                            <input type="number" placeholder="Price" class="service-price" data-service="seo">
                            <input type="text" placeholder="Unit" class="service-unit" data-service="seo" value="Month">
                        </div>
                    </div>
                    
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="social">
                            <span class="service-name">Social Media Marketing</span>
                        </div>
                        <div class="service-details">
                            <input type="number" placeholder="Quantity" class="service-qty" data-service="social">
                            <input type="number" placeholder="Price" class="service-price" data-service="social">
                            <input type="text" placeholder="Unit" class="service-unit" data-service="social" value="Month">
                        </div>
                    </div>
                    
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="ppc">
                            <span class="service-name">PPC Advertising</span>
                        </div>
                        <div class="service-details">
                            <input type="number" placeholder="Quantity" class="service-qty" data-service="ppc">
                            <input type="number" placeholder="Price" class="service-price" data-service="ppc">
                            <input type="text" placeholder="Unit" class="service-unit" data-service="ppc" value="Month">
                        </div>
                    </div>
                    
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="content">
                            <span class="service-name">Content Marketing</span>
                        </div>
                        <div class="service-details">
                            <input type="number" placeholder="Quantity" class="service-qty" data-service="content">
                            <input type="number" placeholder="Price" class="service-price" data-service="content">
                            <input type="text" placeholder="Unit" class="service-unit" data-service="content" value="Month">
                        </div>
                    </div>
                    
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="email">
                            <span class="service-name">Email Marketing</span>
                        </div>
                        <div class="service-details">
                            <input type="number" placeholder="Quantity" class="service-qty" data-service="email">
                            <input type="number" placeholder="Price" class="service-price" data-service="email">
                            <input type="text" placeholder="Unit" class="service-unit" data-service="email" value="Month">
                        </div>
                    </div>
                    
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="mobile">
                            <span class="service-name">Mobile App Development</span>
                        </div>
                        <div class="service-details">
                            <input type="number" placeholder="Quantity" class="service-qty" data-service="mobile">
                            <input type="number" placeholder="Price" class="service-price" data-service="mobile">
                            <input type="text" placeholder="Unit" class="service-unit" data-service="mobile" value="Project">
                        </div>
                    </div>
                    
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="erp">
                            <span class="service-name">ERP Solutions</span>
                        </div>
                        <div class="service-details">
                            <input type="number" placeholder="Quantity" class="service-qty" data-service="erp">
                            <input type="number" placeholder="Price" class="service-price" data-service="erp">
                            <input type="text" placeholder="Unit" class="service-unit" data-service="erp" value="License">
                        </div>
                    </div>
                    
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="ecommerce">
                            <span class="service-name">E-commerce Development</span>
                        </div>
                        <div class="service-details">
                            <input type="number" placeholder="Quantity" class="service-qty" data-service="ecommerce">
                            <input type="number" placeholder="Price" class="service-price" data-service="ecommerce">
                            <input type="text" placeholder="Unit" class="service-unit" data-service="ecommerce" value="Project">
                        </div>
                    </div>
                    
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="analytics">
                            <span class="service-name">Analytics & Reporting</span>
                        </div>
                        <div class="service-details">
                            <input type="number" placeholder="Quantity" class="service-qty" data-service="analytics">
                            <input type="number" placeholder="Price" class="service-price" data-service="analytics">
                            <input type="text" placeholder="Unit" class="service-unit" data-service="analytics" value="Month">
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Additional Notes</label>
                    <textarea id="notes" rows="4" placeholder="Add any special terms, conditions, or additional information..."></textarea>
                </div>
            </div>
            
            <div class="preview-section">
                <h2 class="section-title">Live Preview</h2>
                <div id="quotePreview" class="quote-preview">
                    <!-- Quote content will be generated here -->
                </div>
                
                <div class="action-buttons">
                    <button class="btn" onclick="downloadPDF()">📄 Download PDF</button>
                    <button class="btn" onclick="printQuote()">🖨️ Print Quote</button>
                    <button class="btn" onclick="copyQuote()">📋 Copy Link</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Service definitions with professional descriptions
        const serviceDescriptions = {
            'webdev': 'Custom website development with responsive design, modern UI/UX, and SEO optimization',
            'seo': 'Search engine optimization including keyword research, on-page & off-page optimization',
            'social': 'Social media management, content creation, and engagement strategies across platforms',
            'ppc': 'Pay-per-click advertising campaigns on Google Ads, Facebook, and other platforms',
            'content': 'Strategic content creation including blogs, articles, videos, and marketing materials',
            'email': 'Email marketing campaigns, automation, and newsletter management',
            'mobile': 'Native and cross-platform mobile application development for iOS and Android',
            'erp': 'Enterprise resource planning solutions for business process optimization',
            'ecommerce': 'Complete e-commerce platform development with payment integration',
            'analytics': 'Web analytics setup, data tracking, and comprehensive reporting'
        };
        
        // Set default date (30 days from now)
        const today = new Date();
        const futureDate = new Date(today.getTime() + 30 * 24 * 60 * 60 * 1000);
        document.getElementById('validUntil').value = futureDate.toISOString().split('T')[0];
        
        // Auto-generate quote number
        document.getElementById('quoteNumber').value = 'QT-' + Date.now().toString().slice(-6);
        
        // Real-time preview update
        function updatePreview() {
            const companyName = document.getElementById('companyName').value || 'Your Digital Agency';
            const clientName = document.getElementById('clientName').value || 'Client Name';
            const clientEmail = document.getElementById('clientEmail').value || 'client@email.com';
            const quoteNumber = document.getElementById('quoteNumber').value || 'QT-001';
            const currency = document.getElementById('currency').value;
            const taxRate = parseFloat(document.getElementById('taxRate').value) || 0;
            const validUntil = document.getElementById('validUntil').value;
            const notes = document.getElementById('notes').value;
            
            let selectedServices = [];
            let subtotal = 0;
            
            // Collect selected services
            document.querySelectorAll('.service-checkbox:checked').forEach(checkbox => {
                const service = checkbox.dataset.service;
                const qty = parseFloat(document.querySelector(`.service-qty[data-service="${service}"]`).value) || 0;
                const price = parseFloat(document.querySelector(`.service-price[data-service="${service}"]`).value) || 0;
                const unit = document.querySelector(`.service-unit[data-service="${service}"]`).value || 'Item';
                const serviceName = checkbox.parentElement.querySelector('.service-name').textContent;
                
                if (qty > 0 && price > 0) {
                    const total = qty * price;
                    subtotal += total;
                    selectedServices.push({
                        name: serviceName,
                        description: serviceDescriptions[service],
                        quantity: qty,
                        unit: unit,
                        price: price,
                        total: total
                    });
                }
            });
            
            const taxAmount = (subtotal * taxRate) / 100;
            const finalTotal = subtotal + taxAmount;
            
            // Generate HTML preview
            const previewHTML = `
                <div class="quote-header">
                    <div class="company-name">${companyName}</div>
                    <div class="quote-title">Professional Service Quotation</div>
                    <div style="font-size: 1em; margin-top: 10px;">Quote #${quoteNumber}</div>
                </div>
                
                <div class="quote-details">
                    <div class="detail-section">
                        <h4>Bill To:</h4>
                        <p><strong>${clientName}</strong></p>
                        <p>${clientEmail}</p>
                    </div>
                    <div class="detail-section">
                        <h4>Quote Details:</h4>
                        <p><strong>Date:</strong> ${new Date().toLocaleDateString()}</p>
                        <p><strong>Valid Until:</strong> ${validUntil ? new Date(validUntil).toLocaleDateString() : 'N/A'}</p>
                        <p><strong>Currency:</strong> ${currency}</p>
                    </div>
                </div>
                
                ${selectedServices.length > 0 ? `
                <table class="services-table">
                    <thead>
                        <tr>
                            <th>Service Description</th>
                            <th>Qty</th>
                            <th>Unit</th>
                            <th>Rate</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${selectedServices.map(service => `
                        <tr>
                            <td>
                                <strong>${service.name}</strong><br>
                                <small style="color: #6b7280;">${service.description}</small>
                            </td>
                            <td>${service.quantity}</td>
                            <td>${service.unit}</td>
                            <td><span class="currency-symbol">${currency}</span>${service.price.toLocaleString()}</td>
                            <td><span class="currency-symbol">${currency}</span>${service.total.toLocaleString()}</td>
                        </tr>
                        `).join('')}
                    </tbody>
                </table>
                
                <div class="total-section">
                    <div class="total-row">
                        <span>Subtotal:</span>
                        <span><span class="currency-symbol">${currency}</span>${subtotal.toLocaleString()}</span>
                    </div>
                    ${taxRate > 0 ? `
                    <div class="total-row">
                        <span>Tax (${taxRate}%):</span>
                        <span><span class="currency-symbol">${currency}</span>${taxAmount.toLocaleString()}</span>
                    </div>` : ''}
                    <div class="total-row final-total">
                        <span>Total Amount:</span>
                        <span><span class="currency-symbol">${currency}</span>${finalTotal.toLocaleString()}</span>
                    </div>
                </div>
                ` : `
                <div style="text-align: center; padding: 40px; color: #6b7280;">
                    <h3>No services selected</h3>
                    <p>Please select services from the left panel to generate your quote.</p>
                </div>
                `}
                
                ${notes ? `
                <div style="margin-top: 30px; padding: 20px; background: #f8fafc; border-radius: 10px; border-left: 4px solid #4facfe;">
                    <h4 style="margin-bottom: 10px; color: #2d3748;">Additional Notes:</h4>
                    <p style="color: #4a5568; line-height: 1.6;">${notes}</p>
                </div>
                ` : ''}
                
                <div class="quote-footer">
                    <p>Thank you for choosing ${companyName}! We look forward to working with you.</p>
                    <p style="margin-top: 10px; font-size: 0.9em;">This quote is valid until ${validUntil ? new Date(validUntil).toLocaleDateString() : 'specified date'}.</p>
                </div>
            `;
            
            document.getElementById('quotePreview').innerHTML = previewHTML;
        }
        
        // Download PDF function
        function downloadPDF() {
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'mm', 'a4');
            
            const companyName = document.getElementById('companyName').value || 'Your Digital Agency';
            const clientName = document.getElementById('clientName').value || 'Client Name';
            const quoteNumber = document.getElementById('quoteNumber').value || 'QT-001';
            
            // Add content to PDF
            pdf.setFontSize(20);
            pdf.text(companyName, 105, 30, { align: 'center' });
            
            pdf.setFontSize(16);
            pdf.text('Professional Service Quotation', 105, 45, { align: 'center' });
            
            pdf.setFontSize(12);
            pdf.text(`Quote #${quoteNumber}`, 105, 55, { align: 'center' });
            
            // Add more content based on form data
            let yPos = 80;
            pdf.text(`Client: ${clientName}`, 20, yPos);
            yPos += 10;
            pdf.text(`Date: ${new Date().toLocaleDateString()}`, 20, yPos);
            yPos += 10;
            
            // Add selected services to PDF
            const selectedServices = getSelectedServices();
            if (selectedServices.length > 0) {
                yPos += 10;
                pdf.setFontSize(14);
                pdf.text('Services:', 20, yPos);
                yPos += 10;
                
                pdf.setFontSize(10);
                selectedServices.forEach(service => {
                    if (yPos > 250) {
                        pdf.addPage();
                        yPos = 20;
                    }
                    pdf.text(`${service.name} - Qty: ${service.quantity} ${service.unit} @ ${document.getElementById('currency').value}${service.price} = ${document.getElementById('currency').value}${service.total}`, 20, yPos);
                    yPos += 7;
                });
                
                // Add totals
                const subtotal = selectedServices.reduce((sum, service) => sum + service.total, 0);
                const taxRate = parseFloat(document.getElementById('taxRate').value) || 0;
                const taxAmount = (subtotal * taxRate) / 100;
                const finalTotal = subtotal + taxAmount;
                
                yPos += 10;
                pdf.setFontSize(12);
                pdf.text(`Subtotal: ${document.getElementById('currency').value}${subtotal.toLocaleString()}`, 20, yPos);
                yPos += 7;
                if (taxRate > 0) {
                    pdf.text(`Tax (${taxRate}%): ${document.getElementById('currency').value}${taxAmount.toLocaleString()}`, 20, yPos);
                    yPos += 7;
                }
                pdf.setFontSize(14);
                pdf.text(`Total: ${document.getElementById('currency').value}${finalTotal.toLocaleString()}`, 20, yPos);
            }
            
            // Save the PDF
            pdf.save(`Quote_${quoteNumber}_${clientName.replace(/\s+/g, '_')}.pdf`);
        }
        
        // Get selected services helper function
        function getSelectedServices() {
            let selectedServices = [];
            document.querySelectorAll('.service-checkbox:checked').forEach(checkbox => {
                const service = checkbox.dataset.service;
                const qty = parseFloat(document.querySelector(`.service-qty[data-service="${service}"]`).value) || 0;
                const price = parseFloat(document.querySelector(`.service-price[data-service="${service}"]`).value) || 0;
                const unit = document.querySelector(`.service-unit[data-service="${service}"]`).value || 'Item';
                const serviceName = checkbox.parentElement.querySelector('.service-name').textContent;
                
                if (qty > 0 && price > 0) {
                    const total = qty * price;
                    selectedServices.push({
                        name: serviceName,
                        description: serviceDescriptions[service],
                        quantity: qty,
                        unit: unit,
                        price: price,
                        total: total
                    });
                }
            });
            return selectedServices;
        }
        
        // Print quote function
        function printQuote() {
            const printWindow = window.open('', '_blank');
            const quoteContent = document.getElementById('quotePreview').innerHTML;
            
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Quote - ${document.getElementById('quoteNumber').value}</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .quote-header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #4facfe; padding-bottom: 20px; }
                        .company-name { font-size: 2em; margin-bottom: 10px; }
                        .quote-title { font-size: 1.4em; color: #4facfe; margin: 15px 0; }
                        .quote-details { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; }
                        .services-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
                        .services-table th { background: #4facfe; color: white; padding: 10px; text-align: left; }
                        .services-table td { padding: 10px; border-bottom: 1px solid #ddd; }
                        .total-section { background: #f8f9fa; padding: 20px; border-radius: 5px; margin-top: 20px; }
                        .total-row { display: flex; justify-content: space-between; margin-bottom: 10px; }
                        .final-total { font-size: 1.4em; font-weight: bold; border-top: 2px solid #4facfe; padding-top: 15px; margin-top: 15px; }
                        .quote-footer { margin-top: 30px; padding-top: 20px; border-top: 1px solid #ddd; text-align: center; }
                        @media print { body { margin: 0; } }
                    </style>
                </head>
                <body>${quoteContent}</body>
                </html>
            `);
            
            printWindow.document.close();
            printWindow.focus();
            setTimeout(() => {
                printWindow.print();
                printWindow.close();
            }, 250);
        }
        
        // Copy quote link function (generates a shareable data URL)
        function copyQuote() {
            const quoteData = {
                companyName: document.getElementById('companyName').value,
                clientName: document.getElementById('clientName').value,
                clientEmail: document.getElementById('clientEmail').value,
                quoteNumber: document.getElementById('quoteNumber').value,
                currency: document.getElementById('currency').value,
                taxRate: document.getElementById('taxRate').value,
                validUntil: document.getElementById('validUntil').value,
                notes: document.getElementById('notes').value,
                services: getSelectedServices()
            };
            
            const encodedData = btoa(JSON.stringify(quoteData));
            const currentURL = window.location.href.split('?')[0];
            const shareableLink = `${currentURL}?quote=${encodedData}`;
            
            navigator.clipboard.writeText(shareableLink).then(() => {
                alert('Quote link copied to clipboard! You can share this link with your client.');
            }).catch(() => {
                // Fallback for browsers that don't support clipboard API
                const textArea = document.createElement('textarea');
                textArea.value = shareableLink;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('Quote link copied to clipboard! You can share this link with your client.');
            });
        }
        
        // Load quote from URL parameters if present
        function loadQuoteFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const quoteData = urlParams.get('quote');
            
            if (quoteData) {
                try {
                    const decodedData = JSON.parse(atob(quoteData));
                    
                    // Populate form fields
                    document.getElementById('companyName').value = decodedData.companyName || '';
                    document.getElementById('clientName').value = decodedData.clientName || '';
                    document.getElementById('clientEmail').value = decodedData.clientEmail || '';
                    document.getElementById('quoteNumber').value = decodedData.quoteNumber || '';
                    document.getElementById('currency').value = decodedData.currency || ';
                    document.getElementById('taxRate').value = decodedData.taxRate || '18';
                    document.getElementById('validUntil').value = decodedData.validUntil || '';
                    document.getElementById('notes').value = decodedData.notes || '';
                    
                    // Load services
                    if (decodedData.services) {
                        decodedData.services.forEach(service => {
                            const serviceName = service.name.toLowerCase().replace(/\s+/g, '').replace(/[^a-z]/g, '');
                            const serviceElement = document.querySelector(`[data-service="${serviceName}"]`);
                            
                            if (serviceElement) {
                                serviceElement.checked = true;
                                document.querySelector(`.service-qty[data-service="${serviceName}"]`).value = service.quantity;
                                document.querySelector(`.service-price[data-service="${serviceName}"]`).value = service.price;
                                document.querySelector(`.service-unit[data-service="${serviceName}"]`).value = service.unit;
                            }
                        });
                    }
                    
                    updatePreview();
                } catch (e) {
                    console.error('Error loading quote from URL:', e);
                }
            }
        }
        
        // Add event listeners for real-time updates
        document.addEventListener('DOMContentLoaded', function() {
            // Load quote from URL if present
            loadQuoteFromURL();
            
            // Add event listeners to all form inputs
            const inputs = document.querySelectorAll('input, select, textarea');
            inputs.forEach(input => {
                input.addEventListener('input', updatePreview);
                input.addEventListener('change', updatePreview);
            });
            
            // Initial preview update
            updatePreview();
        });
        
        // Auto-save functionality (using sessionStorage for demo)
        function autoSave() {
            const formData = {
                companyName: document.getElementById('companyName').value,
                clientName: document.getElementById('clientName').value,
                clientEmail: document.getElementById('clientEmail').value,
                quoteNumber: document.getElementById('quoteNumber').value,
                currency: document.getElementById('currency').value,
                taxRate: document.getElementById('taxRate').value,
                validUntil: document.getElementById('validUntil').value,
                notes: document.getElementById('notes').value
            };
            
            // Collect service data
            document.querySelectorAll('.service-checkbox').forEach(checkbox => {
                const service = checkbox.dataset.service;
                formData[`${service}_checked`] = checkbox.checked;
                formData[`${service}_qty`] = document.querySelector(`.service-qty[data-service="${service}"]`).value;
                formData[`${service}_price`] = document.querySelector(`.service-price[data-service="${service}"]`).value;
                formData[`${service}_unit`] = document.querySelector(`.service-unit[data-service="${service}"]`).value;
            });
            
            try {
                sessionStorage.setItem('quoteData', JSON.stringify(formData));
            } catch (e) {
                // Storage not available, skip auto-save
            }
        }
        
        // Load auto-saved data
        function loadAutoSaved() {
            try {
                const savedData = sessionStorage.getItem('quoteData');
                if (savedData) {
                    const formData = JSON.parse(savedData);
                    
                    // Restore form fields
                    Object.keys(formData).forEach(key => {
                        if (key.endsWith('_checked') || key.endsWith('_qty') || key.endsWith('_price') || key.endsWith('_unit')) {
                            return; // Handle these separately
                        }
                        
                        const element = document.getElementById(key);
                        if (element) {
                            element.value = formData[key];
                        }
                    });
                    
                    // Restore service data
                    document.querySelectorAll('.service-checkbox').forEach(checkbox => {
                        const service = checkbox.dataset.service;
                        if (formData[`${service}_checked`]) {
                            checkbox.checked = true;
                        }
                        
                        const qtyInput = document.querySelector(`.service-qty[data-service="${service}"]`);
                        const priceInput = document.querySelector(`.service-price[data-service="${service}"]`);
                        const unitInput = document.querySelector(`.service-unit[data-service="${service}"]`);
                        
                        if (qtyInput && formData[`${service}_qty`]) qtyInput.value = formData[`${service}_qty`];
                        if (priceInput && formData[`${service}_price`]) priceInput.value = formData[`${service}_price`];
                        if (unitInput && formData[`${service}_unit`]) unitInput.value = formData[`${service}_unit`];
                    });
                }
            } catch (e) {
                // Storage not available or corrupted data
            }
        }
        
        // Set up auto-save interval
        setInterval(autoSave, 5000); // Auto-save every 5 seconds
        
        // Load auto-saved data on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadAutoSaved();
        });
    </script>
</body>
</html>
