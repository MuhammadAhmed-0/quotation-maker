<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Quotation Maker</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1300px;
            margin: 0 auto;
            background: white;
            border-radius: 25px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.12);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
            min-height: 600px;
        }
        
        .form-section {
            padding: 45px;
            background: linear-gradient(135deg, #fafafb 0%, #f7fafc 100%);
            border-right: 2px solid #e2e8f0;
        }
        
        .preview-section {
            padding: 45px;
            background: linear-gradient(135deg, #ffffff 0%, #fafbff 100%);
            position: relative;
        }
        
        .section-title {
            font-size: 1.6em;
            color: #2d3748;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 700;
        }
        
        .section-title::before {
            content: '';
            width: 4px;
            height: 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 2px;
        }
        
        .form-group {
            margin-bottom: 28px;
            animation: fadeInUp 0.6s ease-out;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #4a5568;
            font-weight: 600;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1em;
            transition: all 0.3s ease;
            background: white;
        }
        
        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-1px);
        }
        
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .service-item {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            padding: 25px;
            transition: all 0.3s ease;
            position: relative;
            overflow: visible;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .service-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transform: scaleX(0);
            transition: transform 0.3s ease;
            border-radius: 15px 15px 0 0;
        }
        
        .service-item:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }
        
        .service-item:hover::before {
            transform: scaleX(1);
        }
        
        .service-header {
            display: flex;
            align-items: center;
            margin-bottom: 18px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(226, 232, 240, 0.5);
        }
        
        .service-checkbox {
            margin-right: 15px;
            width: 22px;
            height: 22px;
            accent-color: #667eea;
        }
        
        .service-name {
            font-weight: 700;
            color: #2d3748;
            font-size: 1.15em;
            line-height: 1.3;
        }
        
        .service-details {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 18px;
        }
        
        .service-details select,
        .service-details input {
            padding: 10px 12px;
            font-size: 0.95em;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            transition: all 0.2s ease;
            min-width: 0;
            background: white;
        }
        
        .service-details select:focus,
        .service-details input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
        }
        
        .service-package {
            width: 100%;
            font-weight: 500;
        }
        
        .service-custom-price {
            margin-top: 8px;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 25px;
            font-size: 1.05em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.5);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .quote-preview {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.07);
            font-family: 'Times New Roman', serif;
            line-height: 1.6;
        }
        
        .quote-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }
        
        .company-name {
            font-size: 2em;
            color: #2d3748;
            margin-bottom: 5px;
            font-weight: 700;
        }
        
        .quote-title {
            font-size: 1.4em;
            color: #667eea;
            margin: 15px 0;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .quote-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .detail-section h4 {
            color: #4a5568;
            margin-bottom: 10px;
            font-size: 1.1em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .services-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            font-size: 0.95em;
        }
        
        .services-table th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 10px;
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .services-table td {
            padding: 12px 10px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .services-table tr:nth-child(even) {
            background-color: #f8fafc;
        }
        
        .total-section {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .final-total {
            font-size: 1.4em;
            font-weight: 700;
            color: #2d3748;
            border-top: 2px solid #667eea;
            padding-top: 15px;
            margin-top: 15px;
        }
        
        .quote-footer {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e2e8f0;
            text-align: center;
            color: #4a5568;
            font-style: italic;
        }
        
        .action-buttons {
            display: flex;
            gap: 18px;
            margin-top: 25px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .currency-symbol {
            font-weight: 600;
            color: #667eea;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .form-section {
                border-right: none;
                border-bottom: 2px solid #e2e8f0;
            }
            
            .services-grid {
                grid-template-columns: 1fr;
            }
            
            .quote-details {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Professional Quotation Maker</h1>
            <p>Create stunning quotes for Digital Marketing, Web Development & ERP Services</p>
        </div>
        
        <div class="main-content">
            <div class="form-section">
                <h2 class="section-title">Quote Configuration</h2>
                
                <div class="form-group">
                    <label>Your Company Name</label>
                    <input type="text" id="companyName" placeholder="Enter your company name" value="Empire Digisol">
                </div>
                
                <div class="form-group">
                    <label>Client Name</label>
                    <input type="text" id="clientName" placeholder="Enter client name">
                </div>
                
                <div class="form-group">
                    <label>Client Email</label>
                    <input type="email" id="clientEmail" placeholder="Enter client email">
                </div>
                
                <div class="form-group">
                    <label>Quote Number</label>
                    <input type="text" id="quoteNumber" placeholder="QT-001">
                </div>
                
                <div class="form-group">
                    <label>Currency</label>
                    <select id="currency">
                        <option value="$">USD ($)</option>
                        <option value="€">EUR (€)</option>
                        <option value="£">GBP (£)</option>
                        <option value="₹">INR (₹)</option>
                        <option value="¥">JPY (¥)</option>
                        <option value="₨">PKR (₨)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Tax Rate (%) - Optional</label>
                    <input type="number" id="taxRate" placeholder="0" value="0" min="0" max="100" step="0.01">
                </div>
                
                <div class="form-group">
                    <label>Valid Until</label>
                    <input type="date" id="validUntil">
                </div>
                
                <h3 class="section-title" style="margin-top: 30px;">Select Services</h3>
                
                <div class="services-grid">
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="webdev">
                            <span class="service-name">Web Development</span>
                        </div>
                        <div class="service-details">
                            <select class="service-package" data-service="webdev">
                                <option value="">Select Package</option>
                                <option value="basic|3000">Basic Website</option>
                                <option value="standard|8000">Standard Website</option>
                                <option value="premium|15000">E-commerce Premium</option>
                                <option value="custom|0">Custom Quote</option>
                            </select>
                            <input type="number" placeholder="Custom Price" class="service-custom-price" data-service="webdev" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="seo">
                            <span class="service-name">SEO Services</span>
                        </div>
                        <div class="service-details">
                            <select class="service-package" data-service="seo">
                                <option value="">Select Package</option>
                                <option value="starter|500">SEO Starter (Monthly)</option>
                                <option value="professional|1200">SEO Professional (Monthly)</option>
                                <option value="enterprise|2500">SEO Enterprise (Monthly)</option>
                                <option value="custom|0">Custom Quote</option>
                            </select>
                            <input type="number" placeholder="Custom Monthly Rate" class="service-custom-price" data-service="seo" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="social">
                            <span class="service-name">Social Media Marketing</span>
                        </div>
                        <div class="service-details">
                            <select class="service-package" data-service="social">
                                <option value="">Select Package</option>
                                <option value="basic|800">Basic Management (Monthly)</option>
                                <option value="fullservice|1500">Full Service (Monthly)</option>
                                <option value="premium|3000">Premium Package (Monthly)</option>
                                <option value="custom|0">Custom Quote</option>
                            </select>
                            <input type="number" placeholder="Custom Monthly Rate" class="service-custom-price" data-service="social" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="ppc">
                            <span class="service-name">PPC Advertising</span>
                        </div>
                        <div class="service-details">
                            <select class="service-package" data-service="ppc">
                                <option value="">Select Package</option>
                                <option value="starter|1000">PPC Starter (Monthly)</option>
                                <option value="growth|2500">Growth Package (Monthly)</option>
                                <option value="enterprise|5000">Enterprise (Monthly)</option>
                                <option value="custom|0">Custom Quote</option>
                            </select>
                            <input type="number" placeholder="Custom Monthly Rate" class="service-custom-price" data-service="ppc" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="content">
                            <span class="service-name">Content Marketing</span>
                        </div>
                        <div class="service-details">
                            <select class="service-package" data-service="content">
                                <option value="">Select Package</option>
                                <option value="basic|600">Basic Content (Monthly)</option>
                                <option value="standard|1200">Standard Package (Monthly)</option>
                                <option value="premium|2000">Premium Content (Monthly)</option>
                                <option value="custom|0">Custom Quote</option>
                            </select>
                            <input type="number" placeholder="Custom Monthly Rate" class="service-custom-price" data-service="content" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="email">
                            <span class="service-name">Email Marketing</span>
                        </div>
                        <div class="service-details">
                            <select class="service-package" data-service="email">
                                <option value="">Select Package</option>
                                <option value="basic|400">Basic Campaigns (Monthly)</option>
                                <option value="advanced|800">Advanced Automation (Monthly)</option>
                                <option value="enterprise|1500">Enterprise (Monthly)</option>
                                <option value="custom|0">Custom Quote</option>
                            </select>
                            <input type="number" placeholder="Custom Monthly Rate" class="service-custom-price" data-service="email" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="mobile">
                            <span class="service-name">Mobile App Development</span>
                        </div>
                        <div class="service-details">
                            <select class="service-package" data-service="mobile">
                                <option value="">Select Package</option>
                                <option value="ios|12000">iOS App</option>
                                <option value="android|12000">Android App</option>
                                <option value="crossplatform|18000">Cross-Platform App</option>
                                <option value="custom|0">Custom Quote</option>
                            </select>
                            <input type="number" placeholder="Custom Project Price" class="service-custom-price" data-service="mobile" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="erp">
                            <span class="service-name">ERP Solutions</span>
                        </div>
                        <div class="service-details">
                            <select class="service-package" data-service="erp">
                                <option value="">Select Package</option>
                                <option value="basic|5000">Basic ERP System</option>
                                <option value="standard|12000">Standard ERP System</option>
                                <option value="enterprise|25000">Enterprise ERP System</option>
                                <option value="custom|0">Custom Quote</option>
                            </select>
                            <input type="number" placeholder="Custom Project Price" class="service-custom-price" data-service="erp" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="ecommerce">
                            <span class="service-name">E-commerce Development</span>
                        </div>
                        <div class="service-details">
                            <select class="service-package" data-service="ecommerce">
                                <option value="">Select Package</option>
                                <option value="basic|4000">Basic Online Store</option>
                                <option value="advanced|8000">Advanced Store</option>
                                <option value="enterprise|15000">Enterprise Store</option>
                                <option value="custom|0">Custom Quote</option>
                            </select>
                            <input type="number" placeholder="Custom Project Price" class="service-custom-price" data-service="ecommerce" style="display: none;">
                        </div>
                    </div>
                    
                    <div class="service-item">
                        <div class="service-header">
                            <input type="checkbox" class="service-checkbox" data-service="analytics">
                            <span class="service-name">Analytics & Reporting</span>
                        </div>
                        <div class="service-details">
                            <select class="service-package" data-service="analytics">
                                <option value="">Select Package</option>
                                <option value="basic|300">Basic Analytics (Monthly)</option>
                                <option value="advanced|600">Advanced Reports (Monthly)</option>
                                <option value="enterprise|1200">Enterprise Analytics (Monthly)</option>
                                <option value="custom|0">Custom Quote</option>
                            </select>
                            <input type="number" placeholder="Custom Monthly Rate" class="service-custom-price" data-service="analytics" style="display: none;">
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Additional Notes</label>
                    <textarea id="notes" rows="4" placeholder="Add any special terms, conditions, or additional information..."></textarea>
                </div>
            </div>
            
            <div class="preview-section">
                <h2 class="section-title">Live Preview</h2>
                <div id="quotePreview" class="quote-preview">
                    <!-- Quote content will be generated here -->
                </div>
                
                <div class="action-buttons">
                    <button class="btn" onclick="downloadPDF()">📄 Download PDF</button>
                    <button class="btn" onclick="printQuote()">🖨️ Print Quote</button>
                    <button class="btn" onclick="copyQuote()">📋 Copy Link</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Service definitions with professional descriptions
        const serviceDescriptions = {
            'webdev': 'Custom website development with responsive design, modern UI/UX, and SEO optimization',
            'seo': 'Search engine optimization including keyword research, on-page & off-page optimization',
            'social': 'Social media management, content creation, and engagement strategies across platforms',
            'ppc': 'Pay-per-click advertising campaigns on Google Ads, Facebook, and other platforms',
            'content': 'Strategic content creation including blogs, articles, videos, and marketing materials',
            'email': 'Email marketing campaigns, automation, and newsletter management',
            'mobile': 'Native and cross-platform mobile application development for iOS and Android',
            'erp': 'Enterprise resource planning solutions for business process optimization',
            'ecommerce': 'Complete e-commerce platform development with payment integration',
            'analytics': 'Web analytics setup, data tracking, and comprehensive reporting'
        };
        
        // Set default date (30 days from now)
        const today = new Date();
        const futureDate = new Date(today.getTime() + 30 * 24 * 60 * 60 * 1000);
        document.getElementById('validUntil').value = futureDate.toISOString().split('T')[0];
        
        // Auto-generate quote number
        document.getElementById('quoteNumber').value = 'QT-' + Date.now().toString().slice(-6);
        
        // Real-time preview update
        function updatePreview() {
            const companyName = document.getElementById('companyName').value || 'Empire Digisol';
            const clientName = document.getElementById('clientName').value || 'Client Name';
            const clientEmail = document.getElementById('clientEmail').value || 'client@email.com';
            const quoteNumber = document.getElementById('quoteNumber').value || 'QT-001';
            const currency = document.getElementById('currency').value;
            const taxRate = parseFloat(document.getElementById('taxRate').value) || 0;
            const validUntil = document.getElementById('validUntil').value;
            const notes = document.getElementById('notes').value;
            
            let selectedServices = [];
            let subtotal = 0;
            
            // Collect selected services using new package system
            document.querySelectorAll('.service-checkbox:checked').forEach(checkbox => {
                const service = checkbox.dataset.service;
                const serviceName = checkbox.parentElement.querySelector('.service-name').textContent;
                const packageSelect = document.querySelector(`.service-package[data-service="${service}"]`);
                const customPriceInput = document.querySelector(`.service-custom-price[data-service="${service}"]`);
                
                if (packageSelect && packageSelect.value) {
                    const [packageType, packagePrice] = packageSelect.value.split('|');
                    let price = parseFloat(packagePrice);
                    let packageName = packageSelect.options[packageSelect.selectedIndex].text;
                    
                    // Handle custom pricing
                    if (packageType === 'custom' && customPriceInput && customPriceInput.value) {
                        price = parseFloat(customPriceInput.value) || 0;
                        packageName = `${serviceName} - Custom Quote`;
                    }
                    
                    if (price > 0) {
                        subtotal += price;
                        selectedServices.push({
                            name: packageName,
                            description: serviceDescriptions[service] || `Professional ${serviceName.toLowerCase()} service`,
                            quantity: 1,
                            unit: packageType === 'custom' ? 'Custom' : 'Package',
                            price: price,
                            total: price
                        });
                    }
                }
            });
            
            const taxAmount = (subtotal * taxRate) / 100;
            const finalTotal = subtotal + taxAmount;
            
            // Generate HTML preview
            const previewHTML = `
                <div class="quote-header">
                    <div class="company-name">${companyName}</div>
                    <div class="quote-title">Professional Service Quotation</div>
                    <div style="font-size: 1em; margin-top: 10px;">Quote #${quoteNumber}</div>
                </div>
                
                <div class="quote-details">
                    <div class="detail-section">
                        <h4>Bill To:</h4>
                        <p><strong>${clientName}</strong></p>
                        <p>${clientEmail}</p>
                    </div>
                    <div class="detail-section">
                        <h4>Quote Details:</h4>
                        <p><strong>Date:</strong> ${new Date().toLocaleDateString()}</p>
                        <p><strong>Valid Until:</strong> ${validUntil ? new Date(validUntil).toLocaleDateString() : 'N/A'}</p>
                        <p><strong>Currency:</strong> ${currency}</p>
                    </div>
                </div>
                
                ${selectedServices.length > 0 ? `
                <table class="services-table">
                    <thead>
                        <tr>
                            <th>Service Description</th>
                            <th>Qty</th>
                            <th>Unit</th>
                            <th>Rate</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${selectedServices.map(service => `
                        <tr>
                            <td>
                                <strong>${service.name}</strong><br>
                                <small style="color: #6b7280;">${service.description}</small>
                            </td>
                            <td>${service.quantity}</td>
                            <td>${service.unit}</td>
                            <td><span class="currency-symbol">${currency}</span>${service.price.toLocaleString()}</td>
                            <td><span class="currency-symbol">${currency}</span>${service.total.toLocaleString()}</td>
                        </tr>
                        `).join('')}
                    </tbody>
                </table>
                
                <div class="total-section">
                    <div class="total-row">
                        <span>Subtotal:</span>
                        <span><span class="currency-symbol">${currency}</span>${subtotal.toLocaleString()}</span>
                    </div>
                    ${taxRate > 0 ? `
                    <div class="total-row">
                        <span>Tax (${taxRate}%):</span>
                        <span><span class="currency-symbol">${currency}</span>${taxAmount.toLocaleString()}</span>
                    </div>` : ''}
                    <div class="total-row final-total">
                        <span>Total Amount:</span>
                        <span><span class="currency-symbol">${currency}</span>${finalTotal.toLocaleString()}</span>
                    </div>
                </div>
                ` : `
                <div style="text-align: center; padding: 40px; color: #6b7280;">
                    <h3>No services selected</h3>
                    <p>Please select services from the left panel to generate your quote.</p>
                </div>
                `}
                
                ${notes ? `
                <div style="margin-top: 30px; padding: 20px; background: #f8fafc; border-radius: 10px; border-left: 4px solid #4facfe;">
                    <h4 style="margin-bottom: 10px; color: #2d3748;">Additional Notes:</h4>
                    <p style="color: #4a5568; line-height: 1.6;">${notes}</p>
                </div>
                ` : ''}
                
                <div class="quote-footer">
                    <p>Thank you for choosing ${companyName}! We look forward to working with you.</p>
                    <p style="margin-top: 10px; font-size: 0.9em;">This quote is valid until ${validUntil ? new Date(validUntil).toLocaleDateString() : 'specified date'}.</p>
                </div>
            `;
            
            document.getElementById('quotePreview').innerHTML = previewHTML;
        }
        
        // Download PDF function
        function downloadPDF() {
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'mm', 'a4');
            
            // Get form data
            const companyName = document.getElementById('companyName').value || 'Your Digital Agency';
            const clientName = document.getElementById('clientName').value || 'Client Name';
            const clientEmail = document.getElementById('clientEmail').value || 'client@email.com';
            const quoteNumber = document.getElementById('quoteNumber').value || 'QT-001';
            const validUntil = document.getElementById('validUntil').value;
            const currency = document.getElementById('currency').value;
            const notes = document.getElementById('notes').value;
            
            // Color scheme
            const primaryColor = [102, 126, 234]; // Purple
            const accentColor = [118, 75, 162]; // Darker purple
            const lightGray = [248, 250, 252];
            const darkGray = [45, 55, 72];
            
            // Professional Header with branding area
            pdf.setFillColor(...primaryColor);
            pdf.rect(0, 0, 210, 45, 'F');
            
            // Empire Digisol Logo Area
            pdf.setFillColor(255, 255, 255);
            pdf.roundedRect(15, 10, 24, 24, 3, 3, 'F');
            
            // Logo placeholder with Empire Digisol styling
            pdf.setFillColor(102, 126, 234);
            pdf.roundedRect(17, 12, 20, 20, 2, 2, 'F');
            
            pdf.setTextColor(255, 255, 255);
            pdf.setFont('helvetica', 'bold');
            pdf.setFontSize(8);
            pdf.text('ED', 27, 24, { align: 'center' });
            
            // Company name and header
            pdf.setTextColor(255, 255, 255);
            pdf.setFont('helvetica', 'bold');
            pdf.setFontSize(24);
            pdf.text('Empire Digisol', 45, 20);
            
            pdf.setFont('helvetica', 'normal');
            pdf.setFontSize(12);
            pdf.text('Digital Marketing & Development Solutions', 45, 28);
            
            // Contact info in header
            pdf.setFontSize(9);
            pdf.text('www.empiredigisol.com  |  info@empiredigisol.com  |  +92 (300) 123-4567', 45, 35);
            
            // Quote title section
            pdf.setTextColor(...darkGray);
            pdf.setFont('helvetica', 'bold');
            pdf.setFontSize(28);
            pdf.text('QUOTATION', 150, 65);
            
            pdf.setFont('helvetica', 'normal');
            pdf.setFontSize(11);
            pdf.text(`Quote #: ${quoteNumber}`, 150, 75);
            pdf.text(`Date: ${new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}`, 150, 82);
            
            if (validUntil) {
                const validDate = new Date(validUntil).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
                pdf.text(`Valid Until: ${validDate}`, 150, 89);
            }
            
            // Client information section
            pdf.setFillColor(...lightGray);
            pdf.rect(20, 100, 170, 25, 'F');
            
            pdf.setTextColor(...darkGray);
            pdf.setFont('helvetica', 'bold');
            pdf.setFontSize(14);
            pdf.text('BILL TO:', 25, 110);
            
            pdf.setFont('helvetica', 'normal');
            pdf.setFontSize(11);
            pdf.text(clientName, 25, 118);
            pdf.text(clientEmail, 25, 125);
            
            // Services table header
            let yPos = 135;
            pdf.setFillColor(...primaryColor);
            pdf.rect(20, yPos, 170, 15, 'F');
            
            pdf.setTextColor(255, 255, 255);
            pdf.setFont('helvetica', 'bold');
            pdf.setFontSize(11);
            pdf.text('SERVICE DESCRIPTION', 25, yPos + 10);
            pdf.text('PACKAGE', 120, yPos + 10);
            pdf.text('AMOUNT', 165, yPos + 10, { align: 'right' });
            
            yPos += 15;
            
            // Add selected services with professional formatting
            const selectedServices = getSelectedServices();
            let subtotal = 0;
            
            pdf.setTextColor(...darkGray);
            pdf.setFont('helvetica', 'normal');
            
            selectedServices.forEach((service, index) => {
                if (yPos > 250) {
                    pdf.addPage();
                    yPos = 20;
                }
                
                // Alternating row colors
                if (index % 2 === 0) {
                    pdf.setFillColor(250, 250, 250);
                    pdf.rect(20, yPos, 170, 25, 'F');
                }
                
                pdf.setFontSize(12);
                pdf.setFont('helvetica', 'bold');
                pdf.text(service.name, 25, yPos + 8);
                
                pdf.setFont('helvetica', 'normal');
                pdf.setFontSize(10);
                // Word wrap description
                const description = service.description || '';
                const wrappedDesc = pdf.splitTextToSize(description, 85);
                pdf.text(wrappedDesc[0] || '', 25, yPos + 14);
                if (wrappedDesc[1]) {
                    pdf.text(wrappedDesc[1], 25, yPos + 18);
                }
                
                pdf.setFontSize(11);
                pdf.setFont('helvetica', 'normal');
                pdf.text(`${service.unit}`, 120, yPos + 8);
                
                pdf.setFont('helvetica', 'bold');
                pdf.setFontSize(12);
                pdf.text(`${currency}${service.total.toFixed(2)}`, 185, yPos + 8, { align: 'right' });
                
                subtotal += service.total;
                yPos += 27;
            });
            
            // Totals section
            yPos += 15;
            const taxRate = parseFloat(document.getElementById('taxRate').value) || 0;
            const taxAmount = (subtotal * taxRate) / 100;
            const finalTotal = subtotal + taxAmount;
            
            // Draw line above totals
            pdf.setDrawColor(200, 200, 200);
            pdf.setLineWidth(0.5);
            pdf.line(130, yPos - 5, 190, yPos - 5);
            
            // Subtotal
            pdf.setTextColor(...darkGray);
            pdf.setFont('helvetica', 'normal');
            pdf.setFontSize(12);
            pdf.text('Subtotal:', 130, yPos);
            pdf.text(`${currency}${subtotal.toFixed(2)}`, 185, yPos, { align: 'right' });
            yPos += 10;
            
            // Tax
            if (taxRate > 0) {
                pdf.text(`Tax (${taxRate}%):`, 130, yPos);
                pdf.text(`${currency}${taxAmount.toFixed(2)}`, 185, yPos, { align: 'right' });
                yPos += 10;
            }
            
            // Total with colored background
            pdf.setFillColor(...primaryColor);
            pdf.roundedRect(125, yPos - 3, 65, 16, 2, 2, 'F');
            
            pdf.setTextColor(255, 255, 255);
            pdf.setFont('helvetica', 'bold');
            pdf.setFontSize(16);
            pdf.text('TOTAL:', 130, yPos + 8);
            pdf.text(`${currency}${finalTotal.toFixed(2)}`, 185, yPos + 8, { align: 'right' });
            
            // Notes section
            if (notes) {
                yPos += 25;
                pdf.setTextColor(...darkGray);
                pdf.setFont('helvetica', 'bold');
                pdf.setFontSize(12);
                pdf.text('Additional Notes:', 20, yPos);
                
                yPos += 8;
                pdf.setFont('helvetica', 'normal');
                pdf.setFontSize(10);
                const wrappedNotes = pdf.splitTextToSize(notes, 170);
                pdf.text(wrappedNotes, 20, yPos);
                yPos += (wrappedNotes.length * 5) + 10;
            }
            
            // Professional footer
            const footerY = 270;
            pdf.setFillColor(...lightGray);
            pdf.rect(0, footerY - 5, 210, 40, 'F');
            
            pdf.setTextColor(...darkGray);
            pdf.setFont('helvetica', 'bold');
            pdf.setFontSize(11);
            pdf.text('Terms & Conditions:', 20, footerY + 5);
            
            pdf.setFont('helvetica', 'normal');
            pdf.setFontSize(9);
            const terms = [
                '• This quotation is valid for 30 days from the date of issue',
                '• 50% advance payment is required to start the project',
                '• Balance payment is due upon project completion and approval',
                '• Additional revisions beyond agreed scope will be charged separately',
                '• All prices are exclusive of taxes unless otherwise specified'
            ];
            
            terms.forEach((term, index) => {
                pdf.text(term, 20, footerY + 12 + (index * 4));
            });
            
            // Empire Digisol footer branding
            pdf.setFillColor(...primaryColor);
            pdf.rect(0, footerY + 32, 210, 8, 'F');
            
            pdf.setTextColor(255, 255, 255);
            pdf.setFont('helvetica', 'bold');
            pdf.setFontSize(10);
            pdf.text('EMPIRE DIGISOL - Empowering Digital Success', 105, footerY + 37, { align: 'center' });
            
            // Save the PDF with professional filename
            const fileName = `Quotation_${quoteNumber}_${clientName.replace(/[^a-zA-Z0-9]/g, '_')}_${new Date().toISOString().split('T')[0]}.pdf`;
            pdf.save(fileName);
        }
        
        // Get selected services helper function
        function getSelectedServices() {
            let selectedServices = [];
            document.querySelectorAll('.service-checkbox:checked').forEach(checkbox => {
                const service = checkbox.dataset.service;
                const serviceName = checkbox.parentElement.querySelector('.service-name').textContent;
                const packageSelect = document.querySelector(`.service-package[data-service="${service}"]`);
                const customPriceInput = document.querySelector(`.service-custom-price[data-service="${service}"]`);
                
                if (packageSelect.value) {
                    const [packageType, packagePrice] = packageSelect.value.split('|');
                    let price = parseFloat(packagePrice);
                    let packageName = packageSelect.options[packageSelect.selectedIndex].text;
                    
                    // Handle custom pricing
                    if (packageType === 'custom' && customPriceInput.value) {
                        price = parseFloat(customPriceInput.value) || 0;
                        packageName = `${serviceName} - Custom Quote`;
                    }
                    
                    if (price > 0) {
                        selectedServices.push({
                            name: packageName,
                            description: serviceDescriptions[service] || `Professional ${serviceName.toLowerCase()} service`,
                            quantity: 1,
                            unit: packageType === 'custom' ? 'Custom' : 'Package',
                            price: price,
                            total: price
                        });
                    }
                }
            });
            return selectedServices;
        }
        
        // Print quote function
        function printQuote() {
            const printWindow = window.open('', '_blank');
            const quoteContent = document.getElementById('quotePreview').innerHTML;
            
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Quote - ${document.getElementById('quoteNumber').value}</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .quote-header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #4facfe; padding-bottom: 20px; }
                        .company-name { font-size: 2em; margin-bottom: 10px; }
                        .quote-title { font-size: 1.4em; color: #4facfe; margin: 15px 0; }
                        .quote-details { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; }
                        .services-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
                        .services-table th { background: #4facfe; color: white; padding: 10px; text-align: left; }
                        .services-table td { padding: 10px; border-bottom: 1px solid #ddd; }
                        .total-section { background: #f8f9fa; padding: 20px; border-radius: 5px; margin-top: 20px; }
                        .total-row { display: flex; justify-content: space-between; margin-bottom: 10px; }
                        .final-total { font-size: 1.4em; font-weight: bold; border-top: 2px solid #4facfe; padding-top: 15px; margin-top: 15px; }
                        .quote-footer { margin-top: 30px; padding-top: 20px; border-top: 1px solid #ddd; text-align: center; }
                        @media print { body { margin: 0; } }
                    </style>
                </head>
                <body>${quoteContent}</body>
                </html>
            `);
            
            printWindow.document.close();
            printWindow.focus();
            setTimeout(() => {
                printWindow.print();
                printWindow.close();
            }, 250);
        }
        
        // Copy quote link function (generates a shareable data URL)
        function copyQuote() {
            const quoteData = {
                companyName: document.getElementById('companyName').value,
                clientName: document.getElementById('clientName').value,
                clientEmail: document.getElementById('clientEmail').value,
                quoteNumber: document.getElementById('quoteNumber').value,
                currency: document.getElementById('currency').value,
                taxRate: document.getElementById('taxRate').value,
                validUntil: document.getElementById('validUntil').value,
                notes: document.getElementById('notes').value,
                services: getSelectedServices()
            };
            
            const encodedData = btoa(JSON.stringify(quoteData));
            const currentURL = window.location.href.split('?')[0];
            const shareableLink = `${currentURL}?quote=${encodedData}`;
            
            navigator.clipboard.writeText(shareableLink).then(() => {
                alert('Quote link copied to clipboard! You can share this link with your client.');
            }).catch(() => {
                // Fallback for browsers that don't support clipboard API
                const textArea = document.createElement('textarea');
                textArea.value = shareableLink;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('Quote link copied to clipboard! You can share this link with your client.');
            });
        }
        
        // Load quote from URL parameters if present
        function loadQuoteFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const quoteData = urlParams.get('quote');
            
            if (quoteData) {
                try {
                    const decodedData = JSON.parse(atob(quoteData));
                    
                    // Populate form fields
                    document.getElementById('companyName').value = decodedData.companyName || '';
                    document.getElementById('clientName').value = decodedData.clientName || '';
                    document.getElementById('clientEmail').value = decodedData.clientEmail || '';
                    document.getElementById('quoteNumber').value = decodedData.quoteNumber || '';
                    document.getElementById('currency').value = decodedData.currency || '$';
                    document.getElementById('taxRate').value = decodedData.taxRate || '18';
                    document.getElementById('validUntil').value = decodedData.validUntil || '';
                    document.getElementById('notes').value = decodedData.notes || '';
                    
                    // Load services
                    if (decodedData.services) {
                        decodedData.services.forEach(service => {
                            const serviceName = service.name.toLowerCase().replace(/\s+/g, '').replace(/[^a-z]/g, '');
                            const serviceElement = document.querySelector(`[data-service="${serviceName}"]`);
                            
                            if (serviceElement) {
                                serviceElement.checked = true;
                                document.querySelector(`.service-qty[data-service="${serviceName}"]`).value = service.quantity;
                                document.querySelector(`.service-price[data-service="${serviceName}"]`).value = service.price;
                                document.querySelector(`.service-unit[data-service="${serviceName}"]`).value = service.unit;
                            }
                        });
                    }
                    
                    updatePreview();
                } catch (e) {
                    console.error('Error loading quote from URL:', e);
                }
            }
        }
        
        // Add event listeners for real-time updates
        document.addEventListener('DOMContentLoaded', function() {
            // Load quote from URL if present
            loadQuoteFromURL();
            
            // Add event listeners to all form inputs
            const inputs = document.querySelectorAll('input, select, textarea');
            inputs.forEach(input => {
                input.addEventListener('input', updatePreview);
                input.addEventListener('change', updatePreview);
            });
            
            // Add event listeners for package selection changes
            const packageSelects = document.querySelectorAll('.service-package');
            packageSelects.forEach(select => {
                select.addEventListener('change', function() {
                    const service = this.dataset.service;
                    const customPriceInput = document.querySelector(`.service-custom-price[data-service="${service}"]`);
                    const [packageType] = this.value.split('|');
                    
                    if (packageType === 'custom') {
                        customPriceInput.style.display = 'block';
                        customPriceInput.setAttribute('required', 'required');
                    } else {
                        customPriceInput.style.display = 'none';
                        customPriceInput.removeAttribute('required');
                        customPriceInput.value = '';
                    }
                    
                    updatePreview();
                });
            });
            
            // Initial preview update
            updatePreview();
        });
        
        // Auto-save functionality (using sessionStorage for demo)
        function autoSave() {
            const formData = {
                companyName: document.getElementById('companyName').value,
                clientName: document.getElementById('clientName').value,
                clientEmail: document.getElementById('clientEmail').value,
                quoteNumber: document.getElementById('quoteNumber').value,
                currency: document.getElementById('currency').value,
                taxRate: document.getElementById('taxRate').value,
                validUntil: document.getElementById('validUntil').value,
                notes: document.getElementById('notes').value
            };
            
            // Collect service data
            document.querySelectorAll('.service-checkbox').forEach(checkbox => {
                const service = checkbox.dataset.service;
                const packageSelect = document.querySelector(`.service-package[data-service="${service}"]`);
                const customPriceInput = document.querySelector(`.service-custom-price[data-service="${service}"]`);
                
                formData[`${service}_checked`] = checkbox.checked;
                formData[`${service}_package`] = packageSelect ? packageSelect.value : '';
                formData[`${service}_custom_price`] = customPriceInput ? customPriceInput.value : '';
            });
            
            try {
                sessionStorage.setItem('quoteData', JSON.stringify(formData));
            } catch (e) {
                // Storage not available, skip auto-save
            }
        }
        
        // Load auto-saved data
        function loadAutoSaved() {
            try {
                const savedData = sessionStorage.getItem('quoteData');
                if (savedData) {
                    const formData = JSON.parse(savedData);
                    
                    // Restore form fields
                    Object.keys(formData).forEach(key => {
                        if (key.endsWith('_checked') || key.endsWith('_qty') || key.endsWith('_price') || key.endsWith('_unit')) {
                            return; // Handle these separately
                        }
                        
                        const element = document.getElementById(key);
                        if (element) {
                            element.value = formData[key];
                        }
                    });
                    
                    // Restore service data
                    document.querySelectorAll('.service-checkbox').forEach(checkbox => {
                        const service = checkbox.dataset.service;
                        if (formData[`${service}_checked`]) {
                            checkbox.checked = true;
                        }
                        
                        const packageSelect = document.querySelector(`.service-package[data-service="${service}"]`);
                        const customPriceInput = document.querySelector(`.service-custom-price[data-service="${service}"]`);
                        
                        if (packageSelect && formData[`${service}_package`]) {
                            packageSelect.value = formData[`${service}_package`];
                            
                            // Show custom price input if custom package is selected
                            const [packageType] = formData[`${service}_package`].split('|');
                            if (packageType === 'custom' && customPriceInput) {
                                customPriceInput.style.display = 'block';
                                if (formData[`${service}_custom_price`]) {
                                    customPriceInput.value = formData[`${service}_custom_price`];
                                }
                            }
                        }
                    });
                }
            } catch (e) {
                // Storage not available or corrupted data
            }
        }
        
        // Set up auto-save interval
        setInterval(autoSave, 5000); // Auto-save every 5 seconds
        
        // Load auto-saved data on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadAutoSaved();
        });
    </script>
</body>
</html>
